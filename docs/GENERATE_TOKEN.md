# GENERATE_TOKEN

### Overview

This attack path aims to locate resources which can generate a token for a given service account. Upon successful exploitation, an attacker will gain the permissions of the target service account.

### Description

Short-lived service account tokens can be generated by the API server. This requires the `create` verb on `serviceaccounts/token` for the targeted service account.

Upon generation of a token, it can be used to perform actions against the API server as the service account.

### Defense

RBAC access to token creation should be reviewed and access restricted to required subjects.

### Cypher Deep-Dive

```cypher
MATCH (src)-[:GRANTS_TOKEN_CREATE]->(dest:ServiceAccount)
```

The above query finds all resources (`src`) that have the permission to create a token for a given service account. The target (`dest`) is the targeted service account.
